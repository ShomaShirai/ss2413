# 障害物回避ゲーム - リアルタイム対戦ゲーム

## 概要
このプロジェクトは、複数プレイヤーが同時に参加できるWebベースのリアルタイム対戦障害物回避ゲームです。プレイヤーはタッチ操作で敵を避けながら、2分間でどれだけ遠くまで進めるかを競います。

## 主な機能
- **リアルタイム多人数対戦**: 複数プレイヤーが同時にゲームに参加
- **タッチ操作**: 画面タップで進行方向を切り替え
- **リアルタイム順位表示**: ゲーム中にプレイヤーの順位がリアルタイムで更新
- **障害物システム**: スライム、ゴースト、スケルトンなどの敵キャラクター
- **アイテムシステム**: 
  - スター：4秒間無敵＆スピードアップ
  - 剣：上位50%のプレイヤーを4秒間減速
- **川落下システム**: 画面端に落ちると5秒間待機、中央から復帰
- **カウントダウン機能**: ゲーム開始前の10秒カウントダウン

## 技術スタック

### バックエンド
- **Python 3.10**
- **Flask** - Webフレームワーク
- **SQLite** - データベース（SQLAlchemy ORM使用）
- **Flask-Migrate** - データベースマイグレーション

### フロントエンド
- **HTML5 Canvas** - ゲーム描画
- **JavaScript (ES6)** - ゲームロジック
- **Bootstrap 5.3.0** - UIスタイリング
- **WWS.js** - カスタムゲームエンジン

### デプロイメント
- **Render.com** - クラウドホスティングプラットフォーム
- **Dockerfile** - コンテナ化
- **Procfile** - プロセス管理

## ゲームルール
1. **制限時間**: 2分間
2. **操作方法**: 画面タップで進行方向を左右に切り替え
3. **障害物**: 
   - 敵に当たると3秒間待機
   - 川に落ちると5秒間待機、中央から復帰
4. **アイテム効果**:
   - スター取得：4秒間無敵＆スピードアップ
   - 剣取得：上位プレイヤーに減速効果を与える
5. **勝利条件**: 2分間で最も遠くまで進んだプレイヤーの勝利

## プロジェクト構成
```
ss2413/
├── app.py              # メインアプリケーション
├── config.py           # 設定ファイル
├── models.py           # データベースモデル
├── views.py            # ビューロジック
├── static/
│   ├── css/
│   │   └── style.css   # スタイルシート
│   ├── js/
│   │   ├── WWS.js      # ゲームエンジン
│   │   ├── game.js     # ゲームメインロジック
│   │   ├── collision.js # 衝突判定
│   │   ├── enemy.js    # 敵管理
│   │   ├── ranking.js  # ランキング処理
│   │   └── ...
│   ├── images/         # ゲーム画像
│   └── sounds/         # サウンドファイル
├── templates/          # HTMLテンプレート
├── Dockerfile         # Docker設定
├── requirements.txt   # Python依存関係
└── runtime.txt       # Python版本指定
```

## 起動方法

### ローカル環境
1. **リポジトリのクローン**
   ```bash
   git clone <repository-url>
   cd ss2413
   ```

2. **依存関係のインストール**
   ```bash
   pip install -r requirements.txt
   ```

3. **データベースの初期化**
   ```bash
   flask db init
   flask db migrate -m "Initial migration"
   flask db upgrade
   ```

4. **アプリケーションの起動**
   ```bash
   python app.py
   ```

5. **ゲームの開始**
   - ブラウザで `http://localhost:5000` にアクセス
   - プレイヤー名に「admin」を入力してログイン
   - 他のプレイヤーも参加可能
   - 管理者（admin）がゲーム開始ボタンを押下

### デプロイメント（Render.com）
1. GitHubリポジトリをRender.comに接続
2. Web Serviceとして設定
3. 環境変数の設定（必要に応じて）
4. 自動デプロイが実行される

## API エンドポイント
- `POST /api/update_distance` - プレイヤーの進行距離を更新
- `GET /api/ranking` - 現在のランキングを取得
- `GET /api/players` - 参加プレイヤー一覧を取得
- `POST /api/apply_slow_effect` - 減速効果を適用
- `GET /api/batch_data` - バッチでゲームデータを取得
- `POST /start_game` - ゲーム開始
- `POST /api/db_reset` - データベースリセット（管理者のみ）

## 開発予定・改善点
### サーバーサイド
- ゲーム終了時の大量出力を数回の出力に変更
- パフォーマンス最適化

### クライアントサイド  
- ログイン画面のUI改善
- レスポンシブデザインの向上
- 音響効果の追加

## 対応ブラウザ
- Chrome（推奨）
- Safari
- Firefox
- Edge

## 注意事項
- スマートフォンでプレイする場合は、プライベートブラウザモードをオフにしてください
- ローカルストレージの使用を許可してください
- マルチタッチは非対応です

## ライセンス
このプロジェクトは教育目的で作成されました。

## 貢献
バグ報告や機能提案は Issues でお知らせください。
